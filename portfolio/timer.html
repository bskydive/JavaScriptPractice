<!DOCTYPE html>
<!-- HTML5 Hello world by kirupa - http://www.kirupa.com/html5/getting_your_feet_wet_html5_pg1.htm -->
<html lang = "en-us">

<head>

    <meta charset = "utf-8">
    <meta name = "viewport" content = "width=device-width, initial-scale=1">
    <title>Pomodoro timer 00:00</title>
    <style type = "text/css">


        #id_timeText {
            padding: 0px;
            margin: 0px;
            font-size: 6em;
        }

        #id_headerControls {
            padding: 1em;
        }

        #id_timeText {
            border-top: 1px solid gray;
        }

        .btnTimer {
            font-size: 1em;
        }

        #id_historyText {
            border-top: 1px solid gray;
        }

        #id_historyText h2 {
            text-transform: uppercase;
            letter-spacing: 0.25em;
            font-weight: bold;
            font-size: 1em;
            margin-bottom: 1.25em;
        }

        #id_historyText ul {
            text-align: left;
            width: 25em;
            margin: 0 auto;
        }

        #id_historyText ul li {
            padding: 0.5em 5em 0.5em 0.5em;
            background: #ddd;
            margin-bottom: 1px;
            position: relative;
        }

        #id_historyText ul li span.time {
            position: absolute;
            right: 1em;
            top: 1em;
            font-size: 0.75em;
        }
    </style>

    <script type = "text/javascript" src = "https://platform.twitter.com/widgets.js"></script>
    <script type = "text/javascript" src = "https://code.jquery.com/jquery-1.11.3.min.js"></script>
    <link rel = "stylesheet" type = "text/css"
          href = "https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">
    <link rel = "stylesheet" type = "text/css" href = "//maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
    <link rel = "stylesheet" type = "text/css"
          href = "//fonts.googleapis.com/css?family=Roboto:400italic,300,700,300italic,400&subset=latin,cyrillic-ext">

    <script>

        //all variables should be global for code minimization(legacy :] ) purposes. The clock is one.
        var timeStart = 0, timeMaxValue = 0, timeNow = 0;

        var timerMaxValue = 25, smallPauseMaxValue = 5;

        function parseTimeToSec(valueText) {
            //splits 00:00 to seconds
            return (valueText.split(":")[0].replace(/\s+/g, '').toNumber() * 60) + valueText.split(":")[1].replace(/\s+/g, '').toNumber();
        }

        function startTimer() {

            timeStart = performance.now();
            recursiveTimeout();
        }

        function recursiveTimeout() {
            //it is compromise between stability and accuracy. setInterval can hangs browser or cut timing.
            //I'm using timeout for function exec(best stability), and performance for time calculate(best accuracy).

            var timeoutId = 0;

            timeoutId = setTimeout(function tickTack() {

                if (showTime("id_timeText")) {
                    timeoutId = setTimeout(tickTack, 1000);
                } else {
                    clearTimeout(timeoutId);
                }

            }, 1000);


        }

        function showTime(objectId) {
            //todo arrange all numeric time values to minutes or seconds
            //todo check object redirection is correct

            //dedicated allocation for easy refactoring. "From single line"
            var timeNow = 0, secondsSpend = 0, minutesSpend = 0;
            var continueCondition = false;

            timeNow = performance.now();

            secondsSpend = ((timeNow - timeStart).toFixed() / 1000).toFixed();

            if (timeMaxValue <= secondsSpend) {
                continueCondition = true;
            }//timer stop condition

            secondsSpend = ((timeNow - timeStart).toFixed() / 1000).toFixed();
            minutesSpend = (secondsSpend / 60).toFixed();
            secondsSpend = secondsSpend - minutesSpend * 60;

            document.getElementById('id_timeText').innerHTML = "<p>" + minutesSpend.toString() + ":" + secondsSpend.toString() + ":" + timeNow.toString() + "</p>";

            return continueCondition;
        }


        function incTimer() {
            timerMaxValue = btnControlTextChange(true, timerMaxValue, $("#id_btnTimer"), "briefcase");
        }

        function decTimer() {
            timerMaxValue = btnControlTextChange(false, timerMaxValue, $("#id_btnTimer"), "briefcase");
        }

        function startPause() {
            //todo: add captoon with time showing
            timeStart = performance.now();
        }

        function incSmallPause() {
            smallPauseMaxValue = btnControlTextChange(true, smallPauseMaxValue, $("#id_btnSmallPause"), "bell");
        }

        function decSmallPause() {
            smallPauseMaxValue = btnControlTextChange(false, smallPauseMaxValue, $("#id_btnSmallPause"), "bell");
        }

        function btnControlTextChange(direction, value, objectId, icon) {
            if (direction) {
                if (value <= 55) {
                    value += 5;
                }
            } else {
                if (value >= 10) {
                    value -= 5;
                }
            }

            var valueText = "05";

            if (value > 5) {
                valueText = value.toString();
            }

            objectId.html("<i class = \"glyphicon glyphicon-" + icon + "\"></i> " + valueText);

            return value;
        }

        function minSecSpend(time1, time2) {
            //todo deside where calc min:sec from msec

        }


        $(document).ready(function () {

            $(".row-header").addClass("text-center");
            $("#id_btnTimer").on("click", function () {
                startTimer();
            });
            $("#id_btnTimerDec").on("click", function () {
                decTimer()
            });
            $("#id_btnTimerInc").on("click", function () {
                incTimer()
            });

            $("#id_btnSmallPause").on("click", function () {
                startPause();
            });
            $("#id_btnSmallPauseDec").on("click", function () {
                decSmallPause()
            });
            $("#id_btnSmallPauseInc").on("click", function () {
                incSmallPause()
            });
        });
    </script>


</head>

<body>


<div class = "container-fluid text-center" id = "id_headerControls">

    <button type = "button" class = "btn btn-link" href = "http://pomodorotechnique.com/">
        Таймер Pomodoro
    </button>
    <!--<div class="btn-group " role="group" aria-label="...">-->

    <!--	<button type="button" class="btn btn-default navbar-btn" id="id_btnTimer">-->
    <!--		<i class="glyphicon glyphicon-play"></i> 25 : 00-->
    <!--	</button>-->
    <!--	<button type="button" class="btn btn-default navbar-btn" id="id_btnSmallPause">-->
    <!--		<i class="glyphicon glyphicon-pause"></i> 5 : 00-->
    <!--	</button>-->
    <!--	<button type="button" class="btn btn-default navbar-btn" id="id_btnLargePause">-->
    <!--		<i class="glyphicon glyphicon-pause"></i> 15 : 00-->
    <!--	</button>-->
    <!--</div>-->

    <div class = "btn-group " role = "group" aria-label = "...">

        <button type = "button" class = "btn btn-default  controlBtn" id = "id_btnTimerDec">
            <strong>-</strong>
        </button>
        <button type = "button" class = "btn btn-default  controlBtn" id = "id_btnTimer">
            <i class = "glyphicon glyphicon-briefcase"></i> 25
        </button>
        <button type = "button" class = "btn btn-default  controlBtn" id = "id_btnTimerInc">
            <strong>+</strong>
        </button>
    </div>

    <div class = "btn-group " role = "group" aria-label = "...">

        <button type = "button" class = "btn btn-default  controlBtn" id = "id_btnSmallPauseDec">
            <strong>-</strong>
        </button>
        <button type = "button" class = "btn btn-default  controlBtn" id = "id_btnSmallPause">
            <i class = "glyphicon glyphicon-bell"></i> 05
        </button>
        <button type = "button" class = "btn btn-default  controlBtn" id = "id_btnSmallPauseInc">
            <strong>+</strong>
        </button>
    </div>


</div>


<div class = "container-fluid text-center" id = "id_timeText">

    <p>00 : 00</p>

</div>

<div class = "container-fluid text-center" id = "id_historyText">
    <h2>История действий</h2>
    <ul class = "list-unstyled">
        <li>started<span class = "time">00 min ago</span></li>
        <li>break<span class = "time">00 min ago</span></li>
    </ul>


</div>

</body>

</html>
